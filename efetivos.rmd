---
title: ""
description: ""
author: 
    - name: "Ítalo Marques-Monteiro"
    - email: "italo.marques.monteiro@outlook.com"
date: "02 set 2023"
output: html_document
---

```{r}
library(tidyverse)
```

```{r}
reb <- sidrar::get_sidra(
    api = "/t/3939/n6/all/v/all/p/last%201/c79/2670,2672,2675,2677,2680,2681,32793,32794") |>
    janitor::clean_names("snake") |>
    dplyr::glimpse()
```

```{r}
reb <- reb |> 
    dplyr::select(
        valor, municipio_codigo, tipo_de_rebanho,
        code_muni = municipio_codigo
    ) |>
    dplyr::glimpse()
```

```{r}
reb <- reb |>
    dplyr::mutate(code_muni = as.double(code_muni)) |>
    dplyr::glimpse()
```

```{r}
muni <- geobr::read_municipality(code_muni = "all", year = 2020)
muni |> 
    #dplyr::count(name_muni)
    dplyr::glimpse()
```

```{r}
rebanho <- muni |>
    dplyr::left_join(reb) |>
    dplyr::glimpse()
```

```{r}
scaleFUN <- function(x) format(round(as.numeric(x), 0), nsmall= 0, big.mark = ",")

# Create line chart theme
theme_swd_line <-   theme(
  plot.title = element_text(size = rel(1.75), color = "steelblue"), 
  plot.margin = margin(20, 20, 20, 20),
  text = element_text(family = "Roboto", color = "#979797"),
  axis.title.x = element_text(hjust = 0, vjust = -0.5),
  axis.title.y = element_blank(),
  axis.text.y = element_blank(),
  line = element_blank(),
  rect = element_blank()
)
```



```{r}
bovinos <- rebanho |>
    dplyr::filter(
        abbrev_state == "RS" &
            tipo_de_rebanho == "Bovino"
            ) |> #dplyr::arrange(desc(valor))
    ggplot2::ggplot() +
        geom_sf(aes(fill = valor / 1000, na.rm = TRUE)) +
    viridis::scale_fill_viridis(discrete = FALSE) +
        theme_void() +
        labs(
            title = "Efetivo bovino do Rio Grande do Sul",
            subtitle = "IBGE [Pesquisa pecuária municipal (2021) 2023] & geobr (2019) 
            by Ítalo Monteiro ",
        fill = "Número\n[mil cabeças]") +
        theme(
            plot.title = element_text(
                face = "italic", size = 25, hjust = 0.1),
            plot.subtitle = element_text(
                family = "italic", size = 15, color = "gray50", hjust = 0.1),
            plot.caption = element_text(
                face = "italic", size = 12, color = "gray50"),
            axis.text.y = element_blank(),
            #axis.text.y = element_text(
                #size = 14, hjust = 1, family = "Fira Sans"),
            plot.margin = margin(rep(15, 4)),
            panel.background = element_blank(),
            plot.background = element_blank()
        )
bovinos
```


```{r}
ggsave("Image/bovinos.png", plot = bovinos, dpi = 600)
```

equinos
```{r}
equinos <- rebanho |>
    dplyr::filter(
        abbrev_state == "RS" &
            tipo_de_rebanho == "Equino"
            ) |>
    ggplot2::ggplot() +
        geom_sf(aes(fill = valor/1000, na.rm = TRUE)) +
    viridis::scale_fill_viridis(discrete = FALSE) +
        theme_void() +
        labs(
            title = "Efetivo equino do Rio Grande do Sul",
            subtitle = "IBGE [Pesquisa pecuária municipal (2021) 2023] & geobr (2019) 
            by Ítalo Monteiro ",
        fill = "Número\n[mil cabeças]") +
        theme(
            plot.title = element_text(
                face = "italic", size = 25, hjust = 0.1),
            plot.subtitle = element_text(
                family = "italic", size = 15, color = "gray50", hjust = 0.1),
            plot.caption = element_text(
                face = "italic", size = 12, color = "gray50"),
            axis.text.y = element_blank(),
            #axis.text.y = element_text(
                #size = 14, hjust = 1, family = "Fira Sans"),
            plot.margin = margin(rep(15, 4)),
            panel.background = element_blank(),
            plot.background = element_blank()
        )
equinos
```

```{r}
ggsave("Image/equinos.png", plot = equinos, dpi = 600)
```

ovinos
```{r}
ovinos <- rebanho |> 
    dplyr::filter(
        abbrev_state == "RS" &
            tipo_de_rebanho == "Ovino"
            ) |>
    ggplot2::ggplot() +
        geom_sf(aes(fill = valor / 1000, na.rm = TRUE)) +
    viridis::scale_fill_viridis(discrete = FALSE) +
       theme_void() +
        labs(
            title = "Efetivo ovino do Rio Grande do Sul",
           subtitle = "IBGE [Pesquisa pecuária municipal (2021) 2023] & geobr (2019) 
            by Ítalo Monteiro ",
        fill = "Número\n[mil cabeça]") +
        theme(
            plot.title = element_text(
                face = "italic", size = 25, hjust = 0.1),
            plot.subtitle = element_text(
                family = "italic", size = 15, color = "gray50", hjust = 0.1),
            plot.caption = element_text(
                face = "italic", size = 12, color = "gray50"),
            axis.text.y = element_blank(),
            #axis.text.y = element_text(
                #size = 14, hjust = 1, family = "Fira Sans"),
            plot.margin = margin(rep(15, 4)),
            panel.background = element_blank(),
            plot.background = element_blank()
        )
ovinos       
```

```{r}
ggsave("Image/ovinos.png", plot = ovinos, dpi = 600)
```


suinos
```{r}
suinos <- rebanho |> 
    dplyr::filter(
        abbrev_state == "RS" &
            tipo_de_rebanho == "Suíno - total"
            ) |>
    ggplot2::ggplot() +
        geom_sf(aes(fill = valor / 1000, na.rm = TRUE)) +
    viridis::scale_fill_viridis(discrete = FALSE) +
        theme_void() +
        labs(
            title = "Efetivo suíno do Rio Grande do Sul",
           subtitle = "IBGE [Pesquisa pecuária municipal (2021) 2023] & geobr (2019) 
            by Ítalo Monteiro ",
        fill = "Número\n[mil cabeças]") +
        theme(
            plot.title = element_text(
                face = "italic", size = 25, hjust = 0.1),
            plot.subtitle = element_text(
                family = "italic", size = 15, color = "gray50", hjust = 0.1),
            plot.caption = element_text(
                face = "italic", size = 12, color = "gray50"),
            axis.text.y = element_blank(),
            #axis.text.y = element_text(
                #size = 14, hjust = 1, family = "Fira Sans"),
            plot.margin = margin(rep(15, 4)),
            panel.background = element_blank(),
            plot.background = element_blank()
        )
suinos
```

```{r}
ggsave("Image/suinos.png", plot = suinos, dpi = 600)
```


galinhas
```{r}
galinhas <- rebanho |> 
    dplyr::filter(
        abbrev_state == "RS" &
            tipo_de_rebanho == "Galináceos - galinhas"
            ) |>
    ggplot2::ggplot() +
        geom_sf(aes(fill = valor / 1000, na.rm = TRUE)) +
    viridis::scale_fill_viridis(discrete = FALSE) +
        theme_void() +
        labs(
            title = "Efetivo galináceos - galinhas do Rio Grande do Sul",
           subtitle = "IBGE [Pesquisa pecuária municipal (2021) 2023] & geobr (2019) 
            by Ítalo Monteiro ",
        fill = "Número\n[mil cabeças]") +
        theme(
            plot.title = element_text(
                face = "italic", size = 25, hjust = 0.1),
            plot.subtitle = element_text(
                family = "italic", size = 15, color = "gray50", hjust = 0.1),
            plot.caption = element_text(
                face = "italic", size = 12, color = "gray50"),
            axis.text.y = element_blank(),
            #axis.text.y = element_text(
                #size = 14, hjust = 1, family = "Fira Sans"),
            plot.margin = margin(rep(15, 4)),
            panel.background = element_blank(),
            plot.background = element_blank()
        )
galinhas
```

```{r}
ggsave("Image/galinhas.png", plot = galinhas, dpi = 600)
```

bubalino
```{r}
bubalino <- rebanho |>
    dplyr::filter(
        abbrev_state == "RS" &
            tipo_de_rebanho == "Bubalino"
            ) |>
    ggplot2::ggplot() +
        geom_sf(aes(fill = valor / 1000, na.rm = TRUE)) +
    viridis::scale_fill_viridis(discrete = FALSE) +
        theme_void() +
        labs(
            title = "Efetivo bubalino do Rio Grande do Sul",
           subtitle = "IBGE [Pesquisa pecuária municipal (2021) 2023] & geobr (2019) 
            by Ítalo Monteiro ",
        fill = "Número\n[mil cabeças]") +
        theme(
            plot.title = element_text(
                face = "italic", size = 25, hjust = 0.1),
            plot.subtitle = element_text(
                family = "italic", size = 15, color = "gray50", hjust = 0.1),
            plot.caption = element_text(
                face = "italic", size = 12, color = "gray50"),
            axis.text.y = element_blank(),
            #axis.text.y = element_text(
                #size = 14, hjust = 1, family = "Fira Sans"),
            plot.margin = margin(rep(15, 4)),
            panel.background = element_blank(),
            plot.background = element_blank()
        )
bubalino
```

```{r}
ggsave("Image/bubalino.png", plot = bubalino, dpi = 600)
```

caprino
```{r}
caprino <- rebanho |>
    dplyr::filter(
        abbrev_state == "RS" &
            tipo_de_rebanho == "Caprino"
            ) |>
    ggplot2::ggplot() +
        geom_sf(aes(fill = valor, na.rm = TRUE)) +
    viridis::scale_fill_viridis(discrete = FALSE) +
        theme_void() +
        labs(
            title = "Efetivo caprino do Rio Grande do Sul",
           subtitle = "IBGE [Pesquisa pecuária municipal (2021) 2023] & geobr (2019) 
            by Ítalo Monteiro ",
        fill = "Número\n[mil cabeças]") +
        theme(
            plot.title = element_text(
                face = "italic", size = 25, hjust = 0.1),
            plot.subtitle = element_text(
                family = "italic", size = 15, color = "gray50", hjust = 0.1),
            plot.caption = element_text(
                face = "italic", size = 12, color = "gray50"),
            axis.text.y = element_blank(),
            #axis.text.y = element_text(
                #size = 14, hjust = 1, family = "Fira Sans"),
            plot.margin = margin(rep(15, 4)),
            panel.background = element_blank(),
            plot.background = element_blank()
        )
caprino
```

```{r}
ggsave("Image/caprino.png", plot = caprino, dpi = 600)
```

codornas
```{r}
codornas <- rebanho |>
    dplyr::filter(
        abbrev_state == "RS" &
            tipo_de_rebanho == "Codornas"
            ) |>
    ggplot2::ggplot() +
        geom_sf(aes(fill = valor / 1000, na.rm = TRUE)) +
    viridis::scale_fill_viridis(discrete = FALSE) +
        theme_void() +
        labs(
            title = "Efetivo codornas do Rio Grande do Sul",
           subtitle = "IBGE [Pesquisa pecuária municipal (2021) 2023] & geobr (2019) 
            by Ítalo Monteiro ",
        fill = "Número\n[mil cabeças]") +
        theme(
            plot.title = element_text(
                face = "italic", size = 25, hjust = 0.1),
            plot.subtitle = element_text(
                family = "italic", size = 15, color = "gray50", hjust = 0.1),
            plot.caption = element_text(
                face = "italic", size = 12, color = "gray50"),
            axis.text.y = element_blank(),
            #axis.text.y = element_text(
                #size = 14, hjust = 1, family = "Fira Sans"),
            plot.margin = margin(rep(15, 4)),
            panel.background = element_blank(),
            plot.background = element_blank()
        )
codornas
```

```{r}
ggsave("Image/codornas.png", plot = codornas, dpi = 600)
```
